<!DOCTYPE html>
<html>
	<head>
		<title>Frogger</title>
	</head>
	<div id="score">0</div>
	<canvas id="gCanvas" width="600" height="400"></canvas>


	<script>

		var gCanvas = document.getElementById("gCanvas");

		var ctx = gCanvas.getContext("2d");

		const canvasFillColor = 'white';
		const canvasStrokeColor = 'black';

		ctx.fillStyle='canvasFillColor';
		ctx.strokeStyle='canvasStrokeColor';

		const width = gCanvas.width;
		const height = gCanvas.height;

		// fill out border of canvas
		ctx.strokeRect(0, 0, width, height);

		let score = 0;

		// create frog
		const frogHeight = 30;
		const frogWidth = 30;
		var frogX = Math.floor((width/2) - (frogWidth/2));
		var frogY = height - frogHeight;

		const row1Width = 100;
		const row1Height = 50;
		var row1dx = 5; // speed of row1

		const row2Width = 80;
		const row2Height = 50;
		var row2dx = -10; // speed of row2

		// create row 1 objects
		let row1Boxes = [
			{x: 50, y: 300},
			{x: 400, y: 300},
		];		

		let row2Boxes = [
			{x: 20, y: 180},
			{x: 230, y: 180},
			{x: 450, y: 180},
		];

		main();

		document.addEventListener("keydown", move);

		function resetFrogPosition() { 
			frogX = Math.floor((width/2) - (frogWidth/2));
			frogY = height - frogHeight;

			clearCanvas();
			drawFrog();

		}

		function incrementScore(){
			score++;
			document.getElementById('score').innerHTML = score;
		}

		function drawFrog(){
			ctx.fillStyle='lightgreen';

			ctx.fillRect(frogX, frogY, frogWidth, frogHeight);
		}

		function clearCanvas(){
			ctx.fillStyle='white';

			ctx.fillRect(0,0,width,height);
			ctx.strokeRect(0, 0, width, height);
		}


		function move(event) {
			// set key codes
			const LEFT = 37;
			const UP = 38;
			const RIGHT = 39;
			const DOWN = 40;

			const key = event.keyCode;

			if(key == LEFT && frogX > 0){
				frogX -= 20;
			}
			else if(key == RIGHT && frogX < (width-frogWidth)){
				frogX += 20;
			}
			else if(key == UP && frogY > 0){
				frogY -= 20;
			}
			else if(key == DOWN && frogY < (height-frogHeight)){
				frogY += 20;
			}

			if(frogY <= 0){
				// then we reached the end
				incrementScore();

				resetFrogPosition();
			}

			clearCanvas();
			drawFrog();
		}


		function drawRow1() {
			ctx.fillStyle = 'blue'

			ctx.fillRect(row1Boxes[0].x += row1dx, row1Boxes[0].y, row1Width, row1Height);
			ctx.fillRect(row1Boxes[1].x += row1dx, row1Boxes[1].y, row1Width, row1Height);

			// TODO: Wrapping around the edges
			if(row1Boxes[0].x > width){
				row1Boxes[0].x = 0 - row1Width;
			}
			if(row1Boxes[1].x > width){
				row1Boxes[1].x = 0- row1Width;
			}
		}

		function drawRow2() {
			ctx.fillStyle = 'red'

			ctx.fillRect(row2Boxes[0].x += row2dx, row2Boxes[0].y, row2Width, row2Height);
			ctx.fillRect(row2Boxes[1].x += row2dx, row2Boxes[1].y, row2Width, row2Height);
			ctx.fillRect(row2Boxes[2].x += row2dx, row2Boxes[2].y, row2Width, row2Height);

			// TODO: Wrapping around the edges
			if(row2Boxes[0].x < 0){
				row2Boxes[0].x = width + row2Height;
			}
			if(row2Boxes[1].x < 0){
				row2Boxes[1].x = width + row2Width;
			}
			if(row2Boxes[2].x < 0){
				row2Boxes[2].x = width + row2Width;
			}
		}


		function main() {
			setTimeout(function onStep() {
				clearCanvas();
				drawFrog();
				drawRow1();
				drawRow2();

				main();
			}, 50)
		}


		// TODO: create 'enemy' boxes 



	</script>
</html>